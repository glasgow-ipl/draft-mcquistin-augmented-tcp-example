<?xml version='1.0' encoding='US-ASCII'?>
<rfc version='3' ipr='trust200902' submissionType='IETF' docName='draft-mcquistin-augmented-tcp-example-00' category='exp'>
    <front>
        <title abbrev='APHD Example'>
            Describing TCP with Augmented Packet Header Diagrams
        </title>
        <seriesInfo name='Internet-Draft' value='drdraft-mcquistin-augmented-tcp-example-00' status="experimental" />

        <author fullname='Stephen McQuistin' initials='S.' surname='McQuistin'>
            <organization>University of Glasgow</organization>
            <address>
                <postal>
                    <street>School of Computing Science</street>
                    <city>Glasgow</city>
                    <code>G12 8QQ</code>
                    <country>UK</country>
                </postal>
                <email>sm@smcquistin.uk</email>
            </address>
        </author>

        <author fullname='Vivian Band' initials='V.' surname='Band'>
            <organization>University of Glasgow</organization>
            <address>
                <postal>
                    <street>School of Computing Science</street>
                    <city>Glasgow</city>
                    <code>G12 8QQ</code>
                    <country>UK</country>
                </postal>
                <email>vivianband0@gmail.com</email>
            </address>
        </author>

        <author fullname='Dejice Jacob' initials='D.' surname='Jacob'>
            <organization>University of Glasgow</organization>
            <address>
                <postal>
                    <street>School of Computing Science</street>
                    <city>Glasgow</city>
                    <code>G12 8QQ</code>
                    <country>UK</country>
                </postal>
                <email>d.jacob.1@research.gla.ac.uk</email>
            </address>
        </author>

        <author fullname='Colin Perkins' initials='C. S.' surname='Perkins'>
            <organization>University of Glasgow</organization>
            <address>
                <postal>
                    <street>School of Computing Science</street>
                    <city>Glasgow</city>
                    <code>G12 8QQ</code>
                    <country>UK</country>
                </postal>
                <email>csp@csperkins.org</email>
            </address>
        </author>

        <?date year='2020' month='October' day='12'/?>

        <abstract>
            <t>
              This document is an example of the Augmented Packet Header Diagram language. The document describes TCP, and a number of its extensions, using Augmented Packet Header Diagrams.
            </t>
        </abstract>
    </front>

    <middle>
        <section>
            <name>
                Introduction
            </name>
            <t>
                This document uses Augmented Packet Header Diagrams <xref target="AUGMENTED-DIAGRAMS" /> to describe TCP <xref target="RFC793" />, and is intended to further discussion about the design and implementation of the Augmented Packet Header Diagram language and tooling. Given this purpose, this document is not intended as a contribution to any ongoing or future work on maintaining or extending TCP. Further, this document does not necessarily reflect TCP, and its extensions, as presently standardised.
            </t>
        </section>
            <section>
                <name>TCP Header</name>
                <t>
                  This document describes the TCP protocol. The TCP protocol uses TCP Headers.
                </t>
                    <t>
                     A TCP Header is formatted as follows:
                    </t>
                    <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |       Destination Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Acknowledgment Number                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Data |     |N|C|E|U|A|P|R|S|F|                               |
| Offset| Res |S|W|C|R|C|S|S|Y|I|         Window Size           |
|       |     | |R|E|G|K|H|T|N|N|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Checksum            |         Urgent Pointer        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          [Options]                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               :
:                            Payload                            :
:                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    </artwork>
                    <t>
                        where:
                    </t>
                    <dl>
                        <dt>
                            Source Port: 2 bytes.
                        </dt>
                        <dd>
                            <t>
                                Sending port.
                            </t>
                        </dd>
                        <dt>
                            Destination Port: 2 bytes.
                        </dt>
                        <dd>
                            <t>
                                Destination port.
                            </t>
                        </dd>
                        <dt>
                            Sequence Number: 32 bits.
                        </dt>
                        <dd>
                            <t>
                                Sequence number.
                            </t>
                        </dd>
                        <dt>
                            Acknowledgment Number: 32 bits.
                        </dt>
                        <dd>
                            <t>
                                Acknowledgment number.
                            </t>
                        </dd>
                        <dt>
                            Data Offset (DOffset): 4 bits.
                        </dt>
                        <dd>
                            <t>
                                Data offset.
                            </t>
                        </dd>
                        <dt>
                            Reserved: 3 bits.
                        </dt>
                        <dd>
                            <t>
                                Reserved.
                            </t>
                        </dd>
                        <dt>
                            NS: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                NS.
                            </t>
                        </dd>
                        <dt>
                            CWR: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                CWR.
                            </t>
                        </dd>
                        <dt>
                            ECE: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                ECE.
                            </t>
                        </dd>
                        <dt>
                            URG: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                URG.
                            </t>
                        </dd>
                        <dt>
                            Acknowledgment Number: 32 bits.
                        </dt>
                        <dd>
                            <t>
                                Acknowledgment number.
                            </t>
                        </dd>
                        <dt>
                            ACK: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                ACK.
                            </t>
                        </dd>
                        <dt>
                            PSH: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                PSH.
                            </t>
                        </dd>
                        <dt>
                            RST: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                RST.
                            </t>
                        </dd>
                        <dt>
                            SYN: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                SYN.
                            </t>
                        </dd>
                        <dt>
                            FIN: 1 bit.
                        </dt>
                        <dd>
                            <t>
                                FIN.
                            </t>
                        </dd>
                        <dt>
                            Window Size: 16 bits.
                        </dt>
                        <dd>
                            <t>
                                Window size.
                            </t>
                        </dd>
                        <dt>
                            Checksum: 16 bits.
                        </dt>
                        <dd>
                            <t>
                                Checksum.
                            </t>
                        </dd>
                        <dt>
                            Urgent Pointer: 16 bits.
                        </dt>
                        <dd>
                            <t>
                                Urgent pointer.
                            </t>
                        </dd>
                        <dt>
                            Options: [TCP Option]; Options#Size == (DOffset-5)*32; present only when DOffset > 5.
                        </dt>
                        <dd>
                            <t>
                                Options.
                            </t>
                        </dd>
                        <dt>
                            Payload.
                        </dt>
                        <dd>
                            Payload.
                        </dd>
                    </dl>
                </section>

                <section>
                    <name>TCP Options</name>
                        <t>
                            A TCP Option is one of: a EOL Option, a NOOP Option, a Maximum Segment Size Option, a Window Scale Factor Option, a Timestamp Option, or a SACK Permitted Option.
                        </t>
                        <t>
                         An EOL Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       0       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 0.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                        </dl>
                        <t>
                         A NOOP Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       1       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 1.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                        </dl>
                        <t>
                         A Maximum Segment Size Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       2       |     Length    |   Maximum Segment Size (MSS)  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 2.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                            <dt>
                                Option Length (Length): 1 byte; Length == 4.
                            </dt>
                            <dd>
                                <t>
                                    Option length.
                                </t>
                            </dd>
                            <dt>
                                Maximum Segment Size (MSS): 2 bytes.
                            </dt>
                            <dd>
                                <t>
                                    MSS.
                                </t>
                            </dd>
                        </dl>
                        <t>
                         A Window Scale Factor Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       3       |     Length    |       Window Scale Factor     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 3.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                            <dt>
                                Option Length (Length): 1 byte; Length == 3.
                            </dt>
                            <dd>
                                <t>
                                    Option length.
                                </t>
                            </dd>
                            <dt>
                                Window Scale Factor: 1 byte.
                            </dt>
                            <dd>
                                <t>
                                    Window scale factor.
                                </t>
                            </dd>
                        </dl>
                        <t>
                         A Timestamp Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       8       |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Timestamp value (TSval)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Timestamp echo reply (TSecr)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 8.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                            <dt>
                                Option Length (Length): 1 byte; Length == 10.
                            </dt>
                            <dd>
                                <t>
                                    Option length.
                                </t>
                            </dd>
                            <dt>
                                Timestamp value (TSval): 4 bytes.
                            </dt>
                            <dd>
                                <t>
                                    TSval.
                                </t>
                            </dd>
                            <dt>
                                Timestamp echo reply (TSecr): 4 bytes.
                            </dt>
                            <dd>
                                <t>
                                    TSecr.
                                </t>
                            </dd>
                        </dl>
                        <t>
                         A SACK Permitted Option is formatted as follows:
                        </t>
                        <artwork>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       4       |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        </artwork>
                        <t>
                            where:
                        </t>
                        <dl>
                            <dt>
                                Option Kind (Kind): 1 byte; Kind == 4.
                            </dt>
                            <dd>
                                <t>
                                    Option kind.
                                </t>
                            </dd>
                            <dt>
                                Option Length (Length): 1 byte; Length == 2.
                            </dt>
                            <dd>
                                <t>
                                    Option length.
                                </t>
                            </dd>
                        </dl>
                    </section>

        <section anchor='IANA'>
            <name>IANA Considerations</name>
            <t>
                This document contains no actions for IANA.
            </t>
        </section>

        <section anchor='security'>
            <name>Security Considerations</name>
            <t>
                The security implications of the Augmented Packet Header Diagrams format are
                considered in <xref target="AUGMENTED-DIAGRAMS" />.
            </t>
        </section>

        <section anchor='Acknowledgements'>
            <name>Acknowledgements</name>
            <t>
                This work has received funding from the UK Engineering and Physical
                Sciences Research Council under grant EP/R04144X/1.
            </t>
        </section>
    </middle>

    <back>
        <references>
            <name>Informative References</name>
            <reference anchor="AUGMENTED-DIAGRAMS" target="http://www.ietf.org/internet-drafts/draft-mcquistin-augmented-ascii-diagrams-06.txt">
                <front>
                    <title>Describing Protocol Data Units with Augmented Packet Header Diagrams</title>

                    <author initials='S' surname='McQuistin' fullname='Stephen McQuistin'><organization /></author>
                    <author initials='V' surname='Band' fullname='Vivian Band'><organization /></author>
                    <author initials='D' surname='Jacob' fullname='Dejice Jacob'><organization /></author>
                    <author initials='C. S.' surname='Perkins' fullname='Colin Perkins'><organization /></author>

                    <date month='July' day='13' year='2020' />
                </front>

                <seriesInfo name='Internet-Draft' value='draft-mcquistin-augmented-ascii-diagrams-06' />
            </reference>
            <reference anchor="RFC793" target="https://www.rfc-editor.org/info/rfc793">
                <front>
                    <title>Transmission Control Protocol</title>

                    <author initials='J' surname='Postel' fullname='Jon Postel'><organization /></author>

                    <date month='September' year='1981' />
                </front>
                <seriesInfo name='RFC' value='793'/>
            </reference>
        </references>

        <section anchor='source'>
            <name>Source code repository</name>
            <t>
                The source code for tooling that can be used to parse this document, and generate
                parser code for the protocol it describes, is available from <eref target="https://github.com/glasgow-ipl/ips-protodesc-code" />.
            </t>
        </section>
    </back>
 </rfc>
